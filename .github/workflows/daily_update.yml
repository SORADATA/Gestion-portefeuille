name: Daily Portfolio Update

# 1. QUAND ? (DÃ©clencheur)
on:
  schedule:
    - cron: '0 8 * * *'  # Tous les jours Ã  8h00 UTC
  workflow_dispatch:      # Permet de lancer manuellement pour tester

permissions:
  contents: write         # Donne le droit au robot d'Ã©crire dans le repo

# 2. QUOI ? (Les Ã©tapes)
jobs:
  build:
    runs-on: ubuntu-latest # L'ordi virtuel gratuit de GitHub

    steps:
      # A. RÃ©cupÃ©rer ton code
      - name: Checkout code
        uses: actions/checkout@v3

      # B. Installer Python
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      # C. Installer les librairies (pandas, yfinance...)
      - name: Install dependencies
        run: |
          pip install -r requirements.txt

      # D. LANCER TON SCRIPT IA (Le "Coureur")
      - name: Run AI Prediction & Optimization
        run: python daily_run.py

      # E. SAUVEGARDER LE CSV (Commit & Push)
      - name: Commit and Push changes
        run: |
          git config --global user.name 'GitHub Action Bot'
          git config --global user.email 'action@github.com'
          git add portfolio_history.csv
          git commit -m "ðŸ¤– Mise Ã  jour automatique du portefeuille" || echo "Rien Ã  changer"
          git push